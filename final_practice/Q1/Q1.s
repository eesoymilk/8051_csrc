ORG 0030H
MOV A, #01111111B
MOV P1, A
SETB P3.2
SETB P3.3
SETB P2.0

START:

PB1:
JB		P3.2, PB2
CALL 	DELAY
JB		P3.2, PB2

HOLD1:
CALL 	DELAY500
JB		P3.2, PB2
CALL 	DELAY
JB		P3.2, PB2
CALL 	LEFT_SHIFT
JB		P3.2, PB2
CALL 	DELAY
JNB		P3.2, HOLD1

; DE1:
; JNB 	P3.2, $
; CALL 	DELAY
; JNB 	P3.2, DE1

PB2:
JB		P3.3, PB3
CALL 	DELAY
JB		P3.3, PB3

HOLD2:
CALL 	DELAY500
JB		P3.3, PB3
CALL 	DELAY
JB		P3.3, PB3
CALL 	RIGHT_SHIFT
JB		P3.3, PB3
CALL 	DELAY
JNB		P3.3, HOLD2

; JB		P3.3, PB3
; CALL 	DELAY
; JB		P3.3, PB3
; RR		A
; MOV 	P1, A
; DE2:
; JNB 	P3.3, $
; CALL 	DELAY
; JNB 	P3.3, DE2

PB3:
JB		P2.0, DONE
CALL 	DELAY
JB		P2.0, DONE
DE3:
JNB 	P2.0, $
CALL 	DELAY
JNB 	P2.0, DE3
CALL 	RIGHT_SHIFT

DONE:
CALL 	DELAY
SJMP 	START

LEFT_SHIFT:
RR		A
MOV 	P1, A
RET

RIGHT_SHIFT:
RL		A
MOV 	P1, A
RET

DELAY500:
MOV R4, #50
DL1_500:		MOV R5, #20
	DL2_500:    MOV R6, #230
		DL3_500:    DJNZ R6, DL3_500
	DJNZ R5, DL2_500
DJNZ R4, DL1_500
RET

DELAY:
MOV R4, #10
DL1:		MOV R5, #2
	DL2:    MOV R6, #230
		DL3:    DJNZ R6, DL3
	DJNZ R5, DL2
DJNZ R4, DL1
RET

END
